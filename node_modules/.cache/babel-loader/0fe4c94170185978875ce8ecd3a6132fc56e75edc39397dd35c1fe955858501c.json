{"ast":null,"code":"\"use strict\";\n\nvar __classPrivateFieldSet = this && this.__classPrivateFieldSet || function (receiver, state, value, kind, f) {\n  if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n  return kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value), value;\n};\nvar __classPrivateFieldGet = this && this.__classPrivateFieldGet || function (receiver, state, kind, f) {\n  if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n  if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n  return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\nvar _SafeFactory_contractNetworks, _SafeFactory_isL1SafeMasterCopy, _SafeFactory_safeVersion, _SafeFactory_ethAdapter, _SafeFactory_safeProxyFactoryContract, _SafeFactory_gnosisSafeContract;\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nconst ethereumjs_util_1 = require(\"ethereumjs-util\");\nconst satisfies_1 = __importDefault(require(\"semver/functions/satisfies\"));\nconst zksync_web3_1 = require(\"zksync-web3\");\nconst config_1 = require(\"../contracts/config\");\nconst safeDeploymentContracts_1 = require(\"../contracts/safeDeploymentContracts\");\nconst Safe_1 = __importDefault(require(\"../Safe\"));\nconst constants_1 = require(\"../utils/constants\");\nconst utils_1 = require(\"./utils\");\nconst ZKSYNC_MAINNET = 324;\nconst ZKSYNC_TESTNET = 280;\n// For bundle size efficiency we store SafeProxy.sol/GnosisSafeProxy.sol zksync bytecode hash in hex.\n// To get the values below we need to:\n// 1. Compile Safe smart contracts for zksync\n// 2. Get `deployedBytecode` from SafeProxy.json/GnosisSafeProxy.json\n// 3. Use zksync-web3 SDK to get the bytecode hash\n//    const bytecodeHash = zkSyncUtils.hashBytecode(${deployedBytecode})\n// 4. Use ethers to convert the array into hex\n//    const deployedBytecodeHash = ethers.utils.hexlify(bytecodeHash)\nconst ZKSYNC_SAFE_PROXY_DEPLOYED_BYTECODE = {\n  '1.3.0': {\n    deployedBytecodeHash: '0x0100004124426fb9ebb25e27d670c068e52f9ba631bd383279a188be47e3f86d'\n  }\n};\nclass SafeFactory {\n  constructor() {\n    _SafeFactory_contractNetworks.set(this, void 0);\n    _SafeFactory_isL1SafeMasterCopy.set(this, void 0);\n    _SafeFactory_safeVersion.set(this, void 0);\n    _SafeFactory_ethAdapter.set(this, void 0);\n    _SafeFactory_safeProxyFactoryContract.set(this, void 0);\n    _SafeFactory_gnosisSafeContract.set(this, void 0);\n  }\n  static async create(_ref) {\n    let {\n      ethAdapter,\n      safeVersion = config_1.SAFE_LAST_VERSION,\n      isL1SafeMasterCopy = false,\n      contractNetworks\n    } = _ref;\n    const safeFactorySdk = new SafeFactory();\n    await safeFactorySdk.init({\n      ethAdapter,\n      safeVersion,\n      isL1SafeMasterCopy,\n      contractNetworks\n    });\n    return safeFactorySdk;\n  }\n  async init(_ref2) {\n    let {\n      ethAdapter,\n      safeVersion,\n      isL1SafeMasterCopy,\n      contractNetworks\n    } = _ref2;\n    __classPrivateFieldSet(this, _SafeFactory_ethAdapter, ethAdapter, \"f\");\n    __classPrivateFieldSet(this, _SafeFactory_safeVersion, safeVersion, \"f\");\n    __classPrivateFieldSet(this, _SafeFactory_isL1SafeMasterCopy, isL1SafeMasterCopy, \"f\");\n    __classPrivateFieldSet(this, _SafeFactory_contractNetworks, contractNetworks, \"f\");\n    const chainId = await __classPrivateFieldGet(this, _SafeFactory_ethAdapter, \"f\").getChainId();\n    const customContracts = contractNetworks === null || contractNetworks === void 0 ? void 0 : contractNetworks[chainId];\n    __classPrivateFieldSet(this, _SafeFactory_safeProxyFactoryContract, await (0, safeDeploymentContracts_1.getProxyFactoryContract)({\n      ethAdapter,\n      safeVersion,\n      chainId,\n      customContracts\n    }), \"f\");\n    __classPrivateFieldSet(this, _SafeFactory_gnosisSafeContract, await (0, safeDeploymentContracts_1.getSafeContract)({\n      ethAdapter,\n      safeVersion,\n      chainId,\n      isL1SafeMasterCopy,\n      customContracts\n    }), \"f\");\n  }\n  getEthAdapter() {\n    return __classPrivateFieldGet(this, _SafeFactory_ethAdapter, \"f\");\n  }\n  getSafeVersion() {\n    return __classPrivateFieldGet(this, _SafeFactory_safeVersion, \"f\");\n  }\n  getAddress() {\n    return __classPrivateFieldGet(this, _SafeFactory_safeProxyFactoryContract, \"f\").getAddress();\n  }\n  async getChainId() {\n    return __classPrivateFieldGet(this, _SafeFactory_ethAdapter, \"f\").getChainId();\n  }\n  async encodeSetupCallData(_ref3) {\n    let {\n      owners,\n      threshold,\n      to = constants_1.ZERO_ADDRESS,\n      data = constants_1.EMPTY_DATA,\n      fallbackHandler,\n      paymentToken = constants_1.ZERO_ADDRESS,\n      payment = 0,\n      paymentReceiver = constants_1.ZERO_ADDRESS\n    } = _ref3;\n    var _a;\n    if ((0, satisfies_1.default)(__classPrivateFieldGet(this, _SafeFactory_safeVersion, \"f\"), '<=1.0.0')) {\n      return __classPrivateFieldGet(this, _SafeFactory_gnosisSafeContract, \"f\").encode('setup', [owners, threshold, to, data, paymentToken, payment, paymentReceiver]);\n    }\n    let fallbackHandlerAddress;\n    if (fallbackHandler) {\n      fallbackHandlerAddress = fallbackHandler;\n    } else {\n      const chainId = await __classPrivateFieldGet(this, _SafeFactory_ethAdapter, \"f\").getChainId();\n      const customContracts = (_a = __classPrivateFieldGet(this, _SafeFactory_contractNetworks, \"f\")) === null || _a === void 0 ? void 0 : _a[chainId];\n      const fallbackHandlerContract = await (0, safeDeploymentContracts_1.getCompatibilityFallbackHandlerContract)({\n        ethAdapter: __classPrivateFieldGet(this, _SafeFactory_ethAdapter, \"f\"),\n        safeVersion: __classPrivateFieldGet(this, _SafeFactory_safeVersion, \"f\"),\n        chainId,\n        customContracts\n      });\n      fallbackHandlerAddress = fallbackHandlerContract.getAddress();\n    }\n    return __classPrivateFieldGet(this, _SafeFactory_gnosisSafeContract, \"f\").encode('setup', [owners, threshold, to, data, fallbackHandlerAddress, paymentToken, payment, paymentReceiver]);\n  }\n  async predictSafeAddress(_ref4) {\n    let {\n      safeAccountConfig,\n      safeDeploymentConfig\n    } = _ref4;\n    (0, utils_1.validateSafeAccountConfig)(safeAccountConfig);\n    (0, utils_1.validateSafeDeploymentConfig)(safeDeploymentConfig);\n    const from = __classPrivateFieldGet(this, _SafeFactory_safeProxyFactoryContract, \"f\").getAddress();\n    const initializer = await this.encodeSetupCallData(safeAccountConfig);\n    const saltNonce = safeDeploymentConfig.saltNonce;\n    const encodedNonce = (0, ethereumjs_util_1.toBuffer)(__classPrivateFieldGet(this, _SafeFactory_ethAdapter, \"f\").encodeParameters(['uint256'], [saltNonce])).toString('hex');\n    const salt = (0, ethereumjs_util_1.keccak256)((0, ethereumjs_util_1.toBuffer)('0x' + (0, ethereumjs_util_1.keccak256)((0, ethereumjs_util_1.toBuffer)(initializer)).toString('hex') + encodedNonce));\n    const proxyCreationCode = await __classPrivateFieldGet(this, _SafeFactory_safeProxyFactoryContract, \"f\").proxyCreationCode();\n    const input = __classPrivateFieldGet(this, _SafeFactory_ethAdapter, \"f\").encodeParameters(['address'], [__classPrivateFieldGet(this, _SafeFactory_gnosisSafeContract, \"f\").getAddress()]);\n    const chainId = await __classPrivateFieldGet(this, _SafeFactory_ethAdapter, \"f\").getChainId();\n    // zkSync Era counterfactual deployment is calculated differently\n    // https://era.zksync.io/docs/reference/architecture/differences-with-ethereum.html#create-create2\n    if ([ZKSYNC_MAINNET, ZKSYNC_TESTNET].includes(chainId)) {\n      const safeVersion = await __classPrivateFieldGet(this, _SafeFactory_gnosisSafeContract, \"f\").getVersion();\n      const bytecodeHash = ZKSYNC_SAFE_PROXY_DEPLOYED_BYTECODE[safeVersion].deployedBytecodeHash;\n      return zksync_web3_1.utils.create2Address(from, bytecodeHash, salt, input);\n    }\n    const constructorData = (0, ethereumjs_util_1.toBuffer)(input).toString('hex');\n    const initCode = proxyCreationCode + constructorData;\n    const proxyAddress = '0x' + (0, ethereumjs_util_1.generateAddress2)((0, ethereumjs_util_1.toBuffer)(from), (0, ethereumjs_util_1.toBuffer)(salt), (0, ethereumjs_util_1.toBuffer)(initCode)).toString('hex');\n    return __classPrivateFieldGet(this, _SafeFactory_ethAdapter, \"f\").getChecksummedAddress(proxyAddress);\n  }\n  async deploySafe(_ref5) {\n    let {\n      safeAccountConfig,\n      safeDeploymentConfig,\n      options,\n      callback\n    } = _ref5;\n    var _a;\n    (0, utils_1.validateSafeAccountConfig)(safeAccountConfig);\n    if (safeDeploymentConfig) {\n      (0, utils_1.validateSafeDeploymentConfig)(safeDeploymentConfig);\n    }\n    const signerAddress = await __classPrivateFieldGet(this, _SafeFactory_ethAdapter, \"f\").getSignerAddress();\n    if (!signerAddress) {\n      throw new Error('EthAdapter must be initialized with a signer to use this method');\n    }\n    const initializer = await this.encodeSetupCallData(safeAccountConfig);\n    const saltNonce = (_a = safeDeploymentConfig === null || safeDeploymentConfig === void 0 ? void 0 : safeDeploymentConfig.saltNonce) !== null && _a !== void 0 ? _a : (Date.now() * 1000 + Math.floor(Math.random() * 1000)).toString();\n    if ((options === null || options === void 0 ? void 0 : options.gas) && (options === null || options === void 0 ? void 0 : options.gasLimit)) {\n      throw new Error('Cannot specify gas and gasLimit together in transaction options');\n    }\n    const safeAddress = await __classPrivateFieldGet(this, _SafeFactory_safeProxyFactoryContract, \"f\").createProxy({\n      safeMasterCopyAddress: __classPrivateFieldGet(this, _SafeFactory_gnosisSafeContract, \"f\").getAddress(),\n      initializer,\n      saltNonce,\n      options: {\n        from: signerAddress,\n        ...options\n      },\n      callback\n    });\n    const isContractDeployed = await __classPrivateFieldGet(this, _SafeFactory_ethAdapter, \"f\").isContractDeployed(safeAddress);\n    if (!isContractDeployed) {\n      throw new Error('SafeProxy contract is not deployed on the current network');\n    }\n    const safe = await Safe_1.default.create({\n      ethAdapter: __classPrivateFieldGet(this, _SafeFactory_ethAdapter, \"f\"),\n      safeAddress,\n      isL1SafeMasterCopy: __classPrivateFieldGet(this, _SafeFactory_isL1SafeMasterCopy, \"f\"),\n      contractNetworks: __classPrivateFieldGet(this, _SafeFactory_contractNetworks, \"f\")\n    });\n    return safe;\n  }\n}\n_SafeFactory_contractNetworks = new WeakMap(), _SafeFactory_isL1SafeMasterCopy = new WeakMap(), _SafeFactory_safeVersion = new WeakMap(), _SafeFactory_ethAdapter = new WeakMap(), _SafeFactory_safeProxyFactoryContract = new WeakMap(), _SafeFactory_gnosisSafeContract = new WeakMap();\nexports.default = SafeFactory;","map":{"version":3,"names":["ethereumjs_util_1","require","satisfies_1","__importDefault","zksync_web3_1","config_1","safeDeploymentContracts_1","Safe_1","constants_1","utils_1","ZKSYNC_MAINNET","ZKSYNC_TESTNET","ZKSYNC_SAFE_PROXY_DEPLOYED_BYTECODE","deployedBytecodeHash","SafeFactory","constructor","_SafeFactory_contractNetworks","set","_SafeFactory_isL1SafeMasterCopy","_SafeFactory_safeVersion","_SafeFactory_ethAdapter","_SafeFactory_safeProxyFactoryContract","_SafeFactory_gnosisSafeContract","create","_ref","ethAdapter","safeVersion","SAFE_LAST_VERSION","isL1SafeMasterCopy","contractNetworks","safeFactorySdk","init","_ref2","__classPrivateFieldSet","chainId","__classPrivateFieldGet","getChainId","customContracts","getProxyFactoryContract","getSafeContract","getEthAdapter","getSafeVersion","getAddress","encodeSetupCallData","_ref3","owners","threshold","to","ZERO_ADDRESS","data","EMPTY_DATA","fallbackHandler","paymentToken","payment","paymentReceiver","default","encode","fallbackHandlerAddress","_a","fallbackHandlerContract","getCompatibilityFallbackHandlerContract","predictSafeAddress","_ref4","safeAccountConfig","safeDeploymentConfig","validateSafeAccountConfig","validateSafeDeploymentConfig","from","initializer","saltNonce","encodedNonce","toBuffer","encodeParameters","toString","salt","keccak256","proxyCreationCode","input","includes","getVersion","bytecodeHash","utils","create2Address","constructorData","initCode","proxyAddress","generateAddress2","getChecksummedAddress","deploySafe","_ref5","options","callback","signerAddress","getSignerAddress","Error","Date","now","Math","floor","random","gas","gasLimit","safeAddress","createProxy","safeMasterCopyAddress","isContractDeployed","safe","exports"],"sources":["../../../src/safeFactory/index.ts"],"sourcesContent":[null],"mappings":";;;;;;;;;;;;;;;;;;;;;;AAOA,MAAAA,iBAAA,GAAAC,OAAA;AACA,MAAAC,WAAA,GAAAC,eAAA,CAAAF,OAAA;AACA,MAAAG,aAAA,GAAAH,OAAA;AAEA,MAAAI,QAAA,GAAAJ,OAAA;AACA,MAAAK,yBAAA,GAAAL,OAAA;AAKA,MAAAM,MAAA,GAAAJ,eAAA,CAAAF,OAAA;AAEA,MAAAO,WAAA,GAAAP,OAAA;AACA,MAAAQ,OAAA,GAAAR,OAAA;AAmDA,MAAMS,cAAc,GAAG,GAAG;AAC1B,MAAMC,cAAc,GAAG,GAAG;AAC1B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,MAAMC,mCAAmC,GAErC;EACF,OAAO,EAAE;IACPC,oBAAoB,EAAE;;CAEzB;AAED,MAAMC,WAAW;EAAjBC,YAAA;IACEC,6BAAA,CAAAC,GAAA;IACAC,+BAAA,CAAAD,GAAA;IACAE,wBAAA,CAAAF,GAAA;IACAG,uBAAA,CAAAH,GAAA;IACAI,qCAAA,CAAAJ,GAAA;IACAK,+BAAA,CAAAL,GAAA;EA8LF;EA5LE,aAAaM,MAAMA,CAAAC,IAAA,EAKC;IAAA,IALA;MAClBC,UAAU;MACVC,WAAW,GAAGrB,QAAA,CAAAsB,iBAAiB;MAC/BC,kBAAkB,GAAG,KAAK;MAC1BC;IAAgB,CACE,GAAAL,IAAA;IAClB,MAAMM,cAAc,GAAG,IAAIhB,WAAW,EAAE;IACxC,MAAMgB,cAAc,CAACC,IAAI,CAAC;MAAEN,UAAU;MAAEC,WAAW;MAAEE,kBAAkB;MAAEC;IAAgB,CAAE,CAAC;IAC5F,OAAOC,cAAc;EACvB;EAEQ,MAAMC,IAAIA,CAAAC,KAAA,EAKM;IAAA,IALL;MACjBP,UAAU;MACVC,WAAW;MACXE,kBAAkB;MAClBC;IAAgB,CACM,GAAAG,KAAA;IACtBC,sBAAA,KAAI,EAAAb,uBAAA,EAAeK,UAAU;IAC7BQ,sBAAA,KAAI,EAAAd,wBAAA,EAAgBO,WAAW;IAC/BO,sBAAA,KAAI,EAAAf,+BAAA,EAAuBU,kBAAkB;IAC7CK,sBAAA,KAAI,EAAAjB,6BAAA,EAAqBa,gBAAgB;IACzC,MAAMK,OAAO,GAAG,MAAMC,sBAAA,KAAI,EAAAf,uBAAA,MAAY,CAACgB,UAAU,EAAE;IACnD,MAAMC,eAAe,GAAGR,gBAAgB,aAAhBA,gBAAgB,uBAAhBA,gBAAgB,CAAGK,OAAO,CAAC;IACnDD,sBAAA,KAAI,EAAAZ,qCAAA,EAA6B,MAAM,IAAAf,yBAAA,CAAAgC,uBAAuB,EAAC;MAC7Db,UAAU;MACVC,WAAW;MACXQ,OAAO;MACPG;KACD,CAAC;IACFJ,sBAAA,KAAI,EAAAX,+BAAA,EAAuB,MAAM,IAAAhB,yBAAA,CAAAiC,eAAe,EAAC;MAC/Cd,UAAU;MACVC,WAAW;MACXQ,OAAO;MACPN,kBAAkB;MAClBS;KACD,CAAC;EACJ;EAEAG,aAAaA,CAAA;IACX,OAAOL,sBAAA,KAAI,EAAAf,uBAAA,MAAY;EACzB;EAEAqB,cAAcA,CAAA;IACZ,OAAON,sBAAA,KAAI,EAAAhB,wBAAA,MAAa;EAC1B;EAEAuB,UAAUA,CAAA;IACR,OAAOP,sBAAA,KAAI,EAAAd,qCAAA,MAA0B,CAACqB,UAAU,EAAE;EACpD;EAEA,MAAMN,UAAUA,CAAA;IACd,OAAOD,sBAAA,KAAI,EAAAf,uBAAA,MAAY,CAACgB,UAAU,EAAE;EACtC;EAEQ,MAAMO,mBAAmBA,CAAAC,KAAA,EASb;IAAA,IATc;MAChCC,MAAM;MACNC,SAAS;MACTC,EAAE,GAAGvC,WAAA,CAAAwC,YAAY;MACjBC,IAAI,GAAGzC,WAAA,CAAA0C,UAAU;MACjBC,eAAe;MACfC,YAAY,GAAG5C,WAAA,CAAAwC,YAAY;MAC3BK,OAAO,GAAG,CAAC;MACXC,eAAe,GAAG9C,WAAA,CAAAwC;IAAY,CACZ,GAAAJ,KAAA;;IAClB,IAAI,IAAA1C,WAAA,CAAAqD,OAAe,EAACpB,sBAAA,KAAI,EAAAhB,wBAAA,MAAa,EAAE,SAAS,CAAC,EAAE;MACjD,OAAOgB,sBAAA,KAAI,EAAAb,+BAAA,MAAoB,CAACkC,MAAM,CAAC,OAAO,EAAE,CAC9CX,MAAM,EACNC,SAAS,EACTC,EAAE,EACFE,IAAI,EACJG,YAAY,EACZC,OAAO,EACPC,eAAe,CAChB,CAAC;;IAEJ,IAAIG,sBAA8B;IAClC,IAAIN,eAAe,EAAE;MACnBM,sBAAsB,GAAGN,eAAe;KACzC,MAAM;MACL,MAAMjB,OAAO,GAAG,MAAMC,sBAAA,KAAI,EAAAf,uBAAA,MAAY,CAACgB,UAAU,EAAE;MACnD,MAAMC,eAAe,GAAG,CAAAqB,EAAA,GAAAvB,sBAAA,KAAI,EAAAnB,6BAAA,MAAkB,cAAA0C,EAAA,uBAAAA,EAAA,CAAGxB,OAAO,CAAC;MACzD,MAAMyB,uBAAuB,GAAG,MAAM,IAAArD,yBAAA,CAAAsD,uCAAuC,EAAC;QAC5EnC,UAAU,EAAEU,sBAAA,KAAI,EAAAf,uBAAA,MAAY;QAC5BM,WAAW,EAAES,sBAAA,KAAI,EAAAhB,wBAAA,MAAa;QAC9Be,OAAO;QACPG;OACD,CAAC;MACFoB,sBAAsB,GAAGE,uBAAuB,CAACjB,UAAU,EAAE;;IAE/D,OAAOP,sBAAA,KAAI,EAAAb,+BAAA,MAAoB,CAACkC,MAAM,CAAC,OAAO,EAAE,CAC9CX,MAAM,EACNC,SAAS,EACTC,EAAE,EACFE,IAAI,EACJQ,sBAAsB,EACtBL,YAAY,EACZC,OAAO,EACPC,eAAe,CAChB,CAAC;EACJ;EAEA,MAAMO,kBAAkBA,CAAAC,KAAA,EAGL;IAAA,IAHM;MACvBC,iBAAiB;MACjBC;IAAoB,CACH,GAAAF,KAAA;IACjB,IAAArD,OAAA,CAAAwD,yBAAyB,EAACF,iBAAiB,CAAC;IAC5C,IAAAtD,OAAA,CAAAyD,4BAA4B,EAACF,oBAAoB,CAAC;IAElD,MAAMG,IAAI,GAAGhC,sBAAA,KAAI,EAAAd,qCAAA,MAA0B,CAACqB,UAAU,EAAE;IAExD,MAAM0B,WAAW,GAAG,MAAM,IAAI,CAACzB,mBAAmB,CAACoB,iBAAiB,CAAC;IACrE,MAAMM,SAAS,GAAGL,oBAAoB,CAACK,SAAS;IAChD,MAAMC,YAAY,GAAG,IAAAtE,iBAAA,CAAAuE,QAAQ,EAC3BpC,sBAAA,KAAI,EAAAf,uBAAA,MAAY,CAACoD,gBAAgB,CAAC,CAAC,SAAS,CAAC,EAAE,CAACH,SAAS,CAAC,CAAC,CAC5D,CAACI,QAAQ,CAAC,KAAK,CAAC;IAEjB,MAAMC,IAAI,GAAG,IAAA1E,iBAAA,CAAA2E,SAAS,EACpB,IAAA3E,iBAAA,CAAAuE,QAAQ,EAAC,IAAI,GAAG,IAAAvE,iBAAA,CAAA2E,SAAS,EAAC,IAAA3E,iBAAA,CAAAuE,QAAQ,EAACH,WAAW,CAAC,CAAC,CAACK,QAAQ,CAAC,KAAK,CAAC,GAAGH,YAAY,CAAC,CACjF;IAED,MAAMM,iBAAiB,GAAG,MAAMzC,sBAAA,KAAI,EAAAd,qCAAA,MAA0B,CAACuD,iBAAiB,EAAE;IAElF,MAAMC,KAAK,GAAG1C,sBAAA,KAAI,EAAAf,uBAAA,MAAY,CAACoD,gBAAgB,CAC7C,CAAC,SAAS,CAAC,EACX,CAACrC,sBAAA,KAAI,EAAAb,+BAAA,MAAoB,CAACoB,UAAU,EAAE,CAAC,CACxC;IAED,MAAMR,OAAO,GAAG,MAAMC,sBAAA,KAAI,EAAAf,uBAAA,MAAY,CAACgB,UAAU,EAAE;IACnD;IACA;IACA,IAAI,CAAC1B,cAAc,EAAEC,cAAc,CAAC,CAACmE,QAAQ,CAAC5C,OAAO,CAAC,EAAE;MACtD,MAAMR,WAAW,GAAG,MAAMS,sBAAA,KAAI,EAAAb,+BAAA,MAAoB,CAACyD,UAAU,EAAE;MAC/D,MAAMC,YAAY,GAAGpE,mCAAmC,CAACc,WAAW,CAAC,CAACb,oBAAoB;MAC1F,OAAOT,aAAA,CAAA6E,KAAW,CAACC,cAAc,CAACf,IAAI,EAAEa,YAAY,EAAEN,IAAI,EAAEG,KAAK,CAAC;;IAGpE,MAAMM,eAAe,GAAG,IAAAnF,iBAAA,CAAAuE,QAAQ,EAACM,KAAK,CAAC,CAACJ,QAAQ,CAAC,KAAK,CAAC;IACvD,MAAMW,QAAQ,GAAGR,iBAAiB,GAAGO,eAAe;IAEpD,MAAME,YAAY,GAChB,IAAI,GAAG,IAAArF,iBAAA,CAAAsF,gBAAgB,EAAC,IAAAtF,iBAAA,CAAAuE,QAAQ,EAACJ,IAAI,CAAC,EAAE,IAAAnE,iBAAA,CAAAuE,QAAQ,EAACG,IAAI,CAAC,EAAE,IAAA1E,iBAAA,CAAAuE,QAAQ,EAACa,QAAQ,CAAC,CAAC,CAACX,QAAQ,CAAC,KAAK,CAAC;IAC7F,OAAOtC,sBAAA,KAAI,EAAAf,uBAAA,MAAY,CAACmE,qBAAqB,CAACF,YAAY,CAAC;EAC7D;EAEA,MAAMG,UAAUA,CAAAC,KAAA,EAKE;IAAA,IALD;MACf1B,iBAAiB;MACjBC,oBAAoB;MACpB0B,OAAO;MACPC;IAAQ,CACQ,GAAAF,KAAA;;IAChB,IAAAhF,OAAA,CAAAwD,yBAAyB,EAACF,iBAAiB,CAAC;IAC5C,IAAIC,oBAAoB,EAAE;MACxB,IAAAvD,OAAA,CAAAyD,4BAA4B,EAACF,oBAAoB,CAAC;;IAEpD,MAAM4B,aAAa,GAAG,MAAMzD,sBAAA,KAAI,EAAAf,uBAAA,MAAY,CAACyE,gBAAgB,EAAE;IAC/D,IAAI,CAACD,aAAa,EAAE;MAClB,MAAM,IAAIE,KAAK,CAAC,iEAAiE,CAAC;;IAEpF,MAAM1B,WAAW,GAAG,MAAM,IAAI,CAACzB,mBAAmB,CAACoB,iBAAiB,CAAC;IACrE,MAAMM,SAAS,GACb,CAAAX,EAAA,GAAAM,oBAAoB,aAApBA,oBAAoB,uBAApBA,oBAAoB,CAAEK,SAAS,cAAAX,EAAA,cAAAA,EAAA,GAC/B,CAACqC,IAAI,CAACC,GAAG,EAAE,GAAG,IAAI,GAAGC,IAAI,CAACC,KAAK,CAACD,IAAI,CAACE,MAAM,EAAE,GAAG,IAAI,CAAC,EAAE1B,QAAQ,EAAE;IAEnE,IAAI,CAAAiB,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEU,GAAG,MAAIV,OAAO,aAAPA,OAAO,uBAAPA,OAAO,CAAEW,QAAQ,GAAE;MACrC,MAAM,IAAIP,KAAK,CAAC,iEAAiE,CAAC;;IAEpF,MAAMQ,WAAW,GAAG,MAAMnE,sBAAA,KAAI,EAAAd,qCAAA,MAA0B,CAACkF,WAAW,CAAC;MACnEC,qBAAqB,EAAErE,sBAAA,KAAI,EAAAb,+BAAA,MAAoB,CAACoB,UAAU,EAAE;MAC5D0B,WAAW;MACXC,SAAS;MACTqB,OAAO,EAAE;QACPvB,IAAI,EAAEyB,aAAa;QACnB,GAAGF;OACJ;MACDC;KACD,CAAC;IACF,MAAMc,kBAAkB,GAAG,MAAMtE,sBAAA,KAAI,EAAAf,uBAAA,MAAY,CAACqF,kBAAkB,CAACH,WAAW,CAAC;IACjF,IAAI,CAACG,kBAAkB,EAAE;MACvB,MAAM,IAAIX,KAAK,CAAC,2DAA2D,CAAC;;IAE9E,MAAMY,IAAI,GAAG,MAAMnG,MAAA,CAAAgD,OAAI,CAAChC,MAAM,CAAC;MAC7BE,UAAU,EAAEU,sBAAA,KAAI,EAAAf,uBAAA,MAAY;MAC5BkF,WAAW;MACX1E,kBAAkB,EAAEO,sBAAA,KAAI,EAAAjB,+BAAA,MAAoB;MAC5CW,gBAAgB,EAAEM,sBAAA,KAAI,EAAAnB,6BAAA;KACvB,CAAC;IACF,OAAO0F,IAAI;EACb;;;AAGFC,OAAA,CAAApD,OAAA,GAAezC,WAAW"},"metadata":{},"sourceType":"script","externalDependencies":[]}